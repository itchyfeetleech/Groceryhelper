import{r as a,j as G}from"./index-3wXSYsvI.js";function _(e){let t=e;for(;t;){if(t.dir)return t.dir==="rtl";t=t.parentElement}return!1}function ee(e,t){const[o,n]=a.useState(t==="rtl");return a.useLayoutEffect(()=>{e&&(t||n(_(e)))},[t,e]),o}const N=typeof window<"u"?a.useLayoutEffect:a.useEffect;function F(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function te({box:e,defaultHeight:t,defaultWidth:o,disabled:n,element:s,mode:r,style:i}){const{styleHeight:u,styleWidth:c}=a.useMemo(()=>({styleHeight:F(i==null?void 0:i.height),styleWidth:F(i==null?void 0:i.width)}),[i==null?void 0:i.height,i==null?void 0:i.width]),[f,p]=a.useState({height:t,width:o}),C=n||r==="only-height"&&u!==void 0||r==="only-width"&&c!==void 0||u!==void 0&&c!==void 0;return N(()=>{if(s===null||C)return;const g=new ResizeObserver(R=>{for(const h of R){const{contentRect:S,target:y}=h;s===y&&p(v=>v.height===S.height&&v.width===S.width?v:{height:S.height,width:S.width})}});return g.observe(s,{box:e}),()=>{g==null||g.unobserve(s)}},[e,C,s,u,c]),a.useMemo(()=>({height:u??f.height,width:c??f.width}),[f,u,c])}function ne(e){const t=a.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return N(()=>{t.current=e},[e]),a.useCallback(o=>{var n;return(n=t.current)==null?void 0:n.call(t,o)},[t])}let B=null;function oe(e=!1){if(B===null||e){const t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",o.direction="rtl";const n=document.createElement("div"),s=n.style;return s.width="100px",s.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?B="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?B="negative":B="positive-ascending"),document.body.removeChild(t),B}return B}function A({containerElement:e,direction:t,isRtl:o,scrollOffset:n}){if(t==="horizontal"&&o)switch(oe()){case"negative":return-n;case"positive-descending":{if(e){const{clientWidth:s,scrollLeft:r,scrollWidth:i}=e;return i-s-r}break}}return n}function M(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function Z({cachedBounds:e,itemCount:t,itemSize:o}){if(t===0)return 0;if(typeof o=="number")return t*o;{const n=e.get(e.size===0?0:e.size-1);M(n!==void 0,"Unexpected bounds cache miss");const s=(n.scrollOffset+n.size)/e.size;return t*s}}function ie({align:e,cachedBounds:t,index:o,itemCount:n,itemSize:s,containerScrollOffset:r,containerSize:i}){const u=Z({cachedBounds:t,itemCount:n,itemSize:s}),c=t.get(o),f=Math.max(0,Math.min(u-i,c.scrollOffset)),p=Math.max(0,c.scrollOffset-i+c.size);switch(e==="smart"&&(r>=p&&r<=f?e="auto":e="center"),e){case"start":return f;case"end":return p;case"center":return c.scrollOffset<=i/2?0:c.scrollOffset+c.size/2>=u-i/2?u-i:c.scrollOffset+c.size/2-i/2;case"auto":default:return r>=p&&r<=f?r:r<p?p:f}}function Q({cachedBounds:e,containerScrollOffset:t,containerSize:o,itemCount:n,overscanCount:s}){const r=n-1;let i=0,u=-1,c=0;for(;c<r;){const f=e.get(c);if(f.scrollOffset+f.size>t)break;c++}for(i=c,i=Math.max(0,i-s);c<r;){const f=e.get(c);if(f.scrollOffset+f.size>=t+o)break;c++}return u=Math.min(r,c),u=Math.min(n-1,u+s),i<0?[0,-1]:[i,u]}function se({itemCount:e,itemProps:t,itemSize:o}){const n=new Map;return{get(s){for(M(s<e,`Invalid index ${s}`);n.size-1<s;){const i=n.size;let u;switch(typeof o){case"function":{u=o(i,t);break}case"number":{u=o;break}}if(i===0)n.set(i,{size:u,scrollOffset:0});else{const c=n.get(i-1);M(c!==void 0,`Unexpected bounds cache miss for index ${s}`),n.set(i,{scrollOffset:c.scrollOffset+c.size,size:u})}}const r=n.get(s);return M(r!==void 0,`Unexpected bounds cache miss for index ${s}`),r},set(s,r){n.set(s,r)},get size(){return n.size}}}function re({itemCount:e,itemProps:t,itemSize:o}){return a.useMemo(()=>se({itemCount:e,itemProps:t,itemSize:o}),[e,t,o])}function le({containerSize:e,itemSize:t}){let o;switch(typeof t){case"string":{M(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),M(e!==void 0,"Container size must be defined if a percentage item size is specified"),o=e*parseInt(t)/100;break}default:{o=t;break}}return o}function Y({containerElement:e,containerStyle:t,defaultContainerSize:o=0,direction:n,isRtl:s=!1,itemCount:r,itemProps:i,itemSize:u,onResize:c,overscanCount:f}){const[p,C]=a.useState([0,-1]),[g,R]=[Math.min(r-1,p[0]),Math.min(r-1,p[1])],{height:h=o,width:S=o}=te({defaultHeight:n==="vertical"?o:void 0,defaultWidth:n==="horizontal"?o:void 0,element:e,mode:n==="vertical"?"only-height":"only-width",style:t}),y=a.useRef({height:0,width:0}),v=n==="vertical"?h:S,l=le({containerSize:v,itemSize:u});a.useLayoutEffect(()=>{if(typeof c=="function"){const d=y.current;(d.height!==h||d.width!==S)&&(c({height:h,width:S},{...d}),d.height=h,d.width=S)}},[h,c,S]);const m=re({itemCount:r,itemProps:i,itemSize:l}),w=a.useCallback(d=>m.get(d),[m]),W=a.useCallback(()=>Z({cachedBounds:m,itemCount:r,itemSize:l}),[m,r,l]),E=a.useCallback(d=>{const z=A({containerElement:e,direction:n,isRtl:s,scrollOffset:d});return Q({cachedBounds:m,containerScrollOffset:z,containerSize:v,itemCount:r,overscanCount:f})},[m,e,v,n,s,r,f]);N(()=>{const d=(n==="vertical"?e==null?void 0:e.scrollTop:e==null?void 0:e.scrollLeft)??0;C(E(d))},[e,n,E]),N(()=>{if(!e)return;const d=()=>{C(z=>{const{scrollLeft:j,scrollTop:T}=e,b=A({containerElement:e,direction:n,isRtl:s,scrollOffset:n==="vertical"?T:j}),H=Q({cachedBounds:m,containerScrollOffset:b,containerSize:v,itemCount:r,overscanCount:f});return H[0]===z[0]&&H[1]===z[1]?z:H})};return e.addEventListener("scroll",d),()=>{e.removeEventListener("scroll",d)}},[m,e,v,n,r,f]);const x=ne(({align:d="auto",containerScrollOffset:z,index:j})=>{let T=ie({align:d,cachedBounds:m,containerScrollOffset:z,containerSize:v,index:j,itemCount:r,itemSize:l});if(e){if(T=A({containerElement:e,direction:n,isRtl:s,scrollOffset:T}),typeof e.scrollTo!="function"){const b=E(T);(b[0]!==g||b[1]!==R)&&C(b)}return T}});return{getCellBounds:w,getEstimatedSize:W,scrollToIndex:x,startIndex:g,stopIndex:R}}function q(e){return a.useMemo(()=>e,Object.values(e))}function X(e,t){if(e===t)return!0;if(!!e!=!!t||(M(e!==void 0),M(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(const o in e)if(!Object.is(t[o],e[o]))return!1;return!0}function D(e,t){const{style:o,...n}=e,{style:s,...r}=t;return X(o,s)&&X(n,r)}function ae({cellComponent:e,cellProps:t,className:o,columnCount:n,columnWidth:s,defaultHeight:r=0,defaultWidth:i=0,dir:u,gridRef:c,onCellsRendered:f,onResize:p,overscanCount:C=3,rowCount:g,rowHeight:R,style:h,...S}){const y=q(t),v=a.useMemo(()=>a.memo(e,D),[e]),[l,m]=a.useState(null),w=ee(l,u),{getCellBounds:W,getEstimatedSize:E,startIndex:x,scrollToIndex:d,stopIndex:z}=Y({containerElement:l,defaultContainerSize:i,direction:"horizontal",isRtl:w,itemCount:n,itemProps:y,itemSize:s,onResize:p,overscanCount:C}),{getCellBounds:j,getEstimatedSize:T,startIndex:b,scrollToIndex:H,stopIndex:P}=Y({containerElement:l,defaultContainerSize:r,direction:"vertical",itemCount:g,itemProps:y,itemSize:R,onResize:p,overscanCount:C});a.useImperativeHandle(c,()=>({get element(){return l},scrollToCell({behavior:k="auto",columnAlign:O="auto",columnIndex:L,rowAlign:I="auto",rowIndex:$}){const K=d({align:O,containerScrollOffset:(l==null?void 0:l.scrollLeft)??0,index:L}),V=H({align:I,containerScrollOffset:(l==null?void 0:l.scrollTop)??0,index:$});typeof(l==null?void 0:l.scrollTo)=="function"&&l.scrollTo({behavior:k,left:K,top:V})},scrollToColumn({align:k="auto",behavior:O="auto",index:L}){const I=d({align:k,containerScrollOffset:(l==null?void 0:l.scrollLeft)??0,index:L});typeof(l==null?void 0:l.scrollTo)=="function"&&l.scrollTo({behavior:O,left:I})},scrollToRow({align:k="auto",behavior:O="auto",index:L}){const I=H({align:k,containerScrollOffset:(l==null?void 0:l.scrollTop)??0,index:L});typeof(l==null?void 0:l.scrollTo)=="function"&&l.scrollTo({behavior:O,top:I})}}),[l,d,H]),a.useEffect(()=>{x>=0&&z>=0&&b>=0&&P>=0&&f&&f({columnStartIndex:x,columnStopIndex:z,rowStartIndex:b,rowStopIndex:P})},[f,x,z,b,P]);const J=a.useMemo(()=>{const k=[];if(n>0&&g>0)for(let O=b;O<=P;O++){const L=j(O);for(let I=x;I<=z;I++){const $=W(I);k.push(a.createElement(v,{...y,columnIndex:I,key:`${O}-${I}`,rowIndex:O,style:{position:"absolute",left:w?void 0:0,right:w?0:void 0,transform:`translate(${w?-$.scrollOffset:$.scrollOffset}px, ${L.scrollOffset}px)`,height:g>1?L.size:"100%",width:$.size}}))}}return k},[v,y,n,x,z,W,j,w,g,b,P]);return G.jsx("div",{...S,className:o,dir:u,ref:m,style:{width:"100%",height:"100%",...h,maxHeight:"100%",maxWidth:"100%",flexGrow:1,overflow:"auto"},children:G.jsx("div",{className:o,style:{position:"relative",height:T(),width:E()},children:J})})}const ue=a.useState,fe=a.useRef;function de({className:e,defaultHeight:t=0,listRef:o,onResize:n,onRowsRendered:s,overscanCount:r=3,rowComponent:i,rowCount:u,rowHeight:c,rowProps:f,style:p,...C}){const g=q(f),R=a.useMemo(()=>a.memo(i,D),[i]),[h,S]=a.useState(null),{getCellBounds:y,getEstimatedSize:v,scrollToIndex:l,startIndex:m,stopIndex:w}=Y({containerElement:h,defaultContainerSize:t,direction:"vertical",itemCount:u,itemProps:g,itemSize:c,onResize:n,overscanCount:r});a.useImperativeHandle(o,()=>({get element(){return h},scrollToRow({align:E="auto",behavior:x="auto",index:d}){const z=l({align:E,containerScrollOffset:(h==null?void 0:h.scrollTop)??0,index:d});typeof(h==null?void 0:h.scrollTo)=="function"&&h.scrollTo({behavior:x,top:z})}}),[h,l]),a.useEffect(()=>{m>=0&&w>=0&&s&&s({startIndex:m,stopIndex:w})},[s,m,w]);const W=a.useMemo(()=>{const E=[];if(u>0)for(let x=m;x<=w;x++){const d=y(x);E.push(a.createElement(R,{...g,key:x,index:x,style:{position:"absolute",left:0,transform:`translateY(${d.scrollOffset}px)`,height:d.size,width:"100%"}}))}return E},[R,y,u,g,m,w]);return G.jsx("div",{...C,className:e,ref:S,style:{...p,maxHeight:"100%",flexGrow:1,overflowY:"auto"},children:G.jsx("div",{className:e,style:{height:v(),position:"relative",width:"100%"},children:W})})}const he=a.useState,me=a.useRef;let U=-1;function ge(e=!1){if(U===-1||e){const t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",document.body.appendChild(t),U=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return U}export{ae as Grid,de as List,ge as getScrollbarSize,ue as useGridCallbackRef,fe as useGridRef,he as useListCallbackRef,me as useListRef};
